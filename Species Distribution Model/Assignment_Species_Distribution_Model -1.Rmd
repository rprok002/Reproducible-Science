---
title: "Workshop 4: Species Distribution Model"
author: "Rachel Prokopius"
date: "2/7/2020"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Objectives

The primary objectives of this analysis is to build a species distribution model for the provided data of observations of the saguaro cactus in the southeastern United States and northern Mexico.

# Methods

## Site Information 

![Saguaro cactus, *Carnegiea gigantea*](C:/Users/Rachel Prokopius/Documents/FALCON HD/GitHub/Reproducible-Science/Species Distribution Model/cactus image.jpg)

The study species is the saguaro cactus, *Carnegiea gigantea*, is native to the southeastern United States and northern Mexico. The plant is specially adapted to the dry, hot environment of this portion of the world by retaining large quantities of water during the few annual rainstorms and slowly using this water throughout the year. The cactus reproduces via flower blossoms and fruits, and can live to be about 150 years old.   

Species image obtained from https://en.wikipedia.org/wiki/Saguaro
Data set and species distribution model tutorial obtained from https://jcoliver.github.io/learn-r/011-species-distribution-models.html

## Statistical Analysis

Five R packages were loaded and used to analyse the data: sp, raster, maptools, rgdal and dismo.

Saguaro cactus GPS coordinates were uploaded to Rstudio and plotted on a base map of the southwestern United States and northern Mexico. Bioclimate data was downloaded and restricted to the pertaining geographical area of the base map. Pseudo-data points were calculated to allow the model to account for both presence and absence of the cactus. THe observation points and pseudo-data points were randomly sampled into either a training group for building the model or a testing group for testing the validity of the created model. The created model was used to determine a threshold through the "spec_sens" sensitivity for presence and absence data for the saguaro cactus, and the original observations and pseudo-data points were resampled for only the points located above the calculated threshold and replotted on the base map. 


# Results 

![Table 1](C:/Users/Rachel Prokopius/Documents/FALCON HD/GitHub/Reproducible-Science/ARIMA/Table 1.jpg)

All data series in Table 1 had outliers present which were removed through the tsclean package. The test of stationarity for the NEE model without independent variable addition (Model NEE) had a signifiant p-value, and could therefore be used without differencing the series.The maximum salinity and air temperatures were originally determined not to be stationary (Dickey-Fuller = -2.1936, p-value = 0.4952 and Dickey-Fuller = -2.1179, p-value = 0.5272 respectively) and were differenced in order to obtain stationary data series (Table 1). All tested data series showed independence through the Ljung-Box test with p-values greater than 0.05 (Table 1). 

![Figure 1. Plot of presence and absence data for saguaro cactus in the southeastern United States and northern Mexico](C:/Users/Rachel Prokopius/Documents/FALCON HD/GitHub/Reproducible-Science/Species Distribution Model/graph.jpg)

From the species distribution model, the minimun threshold for saguaro cactus presence was 0.009275. Once the model was reconfigured with the threshold, presence and absence data from the model were able to be plotted on the base map of the United States and Mexico (Figure 1).

# Discussion 

When analyzing ARIMA models, the AIC value tests the goodness of fit of the model to the data set. The lower the AIC value is, the better the model fits the data set. While maximum salinity of water at the TS/Ph-7a site in the Florida Everglades generates a model of NEE with an AIC value only slightly lower than the the model generated by NEE alone, air temperature greatly decreases the AIC value of the resulting model (Table 1). This result suggests that air temperature is a better estimator of NEE than maximum salinity is for the TS/Ph-7a site of the Florida Everglades, and would therefore be more useful in creating future projections of NEE (Figure 6). Net Ecosystem Exchange (NEE) is defined as the overall exchange of carbon dioxide in an ecosystem (Chapin et al. 2011). Much of the carbon dioxide exchange in plant ecosystems is due to plant photosynthesis and respiration, both of which are affected by air temperature (Hofstra and Hesketh 1969). Air temperature is also known to fluctuate seasonally,  so data sets with outputs such as NEE that are affected by air temperature are ideal for the use of ARIMA models to account for the effect of seasonality on the dependent variable.

# Literature Cited

1.Chapin III, S. F., Matson, P. A. & Vitousek, P. Principles of Terrestrial Ecosystem Ecology. (Springer-Verlag, 2011). 

2.Hofstra, G. & Hesketh, J. D. Effects of temperature on the gas exchange of leaves in the light and dark. *Planta* 85, 228â€“237 (1969).
